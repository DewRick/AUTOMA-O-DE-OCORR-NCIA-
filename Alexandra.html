<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ocorrência Fini - Controle Rápido</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #e0f7fa; 
            margin: 0; 
            padding: 15px;
        }
        .container { 
            max-width: 420px; 
            margin: 0 auto; 
            background-color: #fff; 
            padding: 20px; 
            border-radius: 12px; 
            box-shadow: 0 0 15px rgba(0,0,0,0.15); 
        }
        h1 { 
            text-align: center; 
            font-size: 1.4em; 
            margin-bottom: 10px; 
            color: #333;
        }
        .lojas-title { 
            background-color: #4682b4; 
            color: white; 
            padding: 12px; 
            border-radius: 50%; 
            text-align: center; 
            margin: 30px auto 20px; 
            width: 150px; 
            font-weight: bold;
            font-size: 1.1em;
        }
        .checkbox-list { 
            margin-bottom: 30px; 
        }
        .checkbox-list label { 
            display: block; 
            margin: 10px 0; 
            font-size: 0.95em; 
        }

        /* Categoria expansível */
        .categoria-header {
            background-color: #c0c0c0; 
            text-align: center; 
            font-weight: bold; 
            font-size: 1.1em; 
            padding: 14px; 
            margin: 25px 0 10px 0; 
            border-radius: 8px;
            cursor: pointer;
            user-select: none;
            position: relative;
        }
        .categoria-header::after {
            content: "▶"; /* Fechado por padrão */
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2em;
            transition: transform 0.3s;
        }
        .categoria-header.open::after {
            content: "▼";
        }
        .categoria-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease;
        }
        .categoria-content.open {
            max-height: 3000px; /* Valor alto para cobrir tudo */
        }

        table { 
            width: 100%; 
            border-collapse: collapse; 
            font-size: 0.82em; 
            margin-bottom: 20px;
        }
        th { 
            background-color: #d9d9d9; 
            padding: 8px 4px; 
            text-align: left; 
            font-size: 0.9em;
        }
        td { 
            padding: 10px 4px; 
            border-bottom: 1px solid #eee; 
        }
        tr:nth-child(even) { background-color: #f8f8f8; }
        .produto { width: 62%; }
        .status { text-align: center; width: 19%; }
        input[type="radio"] { 
            transform: scale(1.5); 
            cursor: pointer;
        }

        .text-box { 
            border: 3px solid #ffd700; 
            background-color: #ffffe0; 
            padding: 20px; 
            margin: 40px 0 20px 0; 
            border-radius: 12px; 
        }
        .text-box h3 { 
            text-align: center; 
            margin: 0 0 15px 0; 
            font-size: 1.1em;
        }
        .star { 
            color: #ffd700; 
            font-size: 32px; 
            text-align: center; 
            margin: 15px 0; 
        }
        .note { 
            font-size: 0.8em; 
            color: #666; 
            text-align: right; 
            margin-top: 15px;
        }
        textarea { 
            width: 100%; 
            min-height: 300px; 
            max-height: 600px; 
            resize: vertical; 
            padding: 12px; 
            box-sizing: border-box; 
            font-family: monospace; 
            font-size: 0.9em; 
            border: 1px solid #ccc; 
            border-radius: 8px;
            margin-top: 10px;
        }
        .copy-btn {
            width: 100%;
            padding: 14px;
            background-color: #4682b4;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            margin-top: 15px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>AUTOMAÇÃO DE OCORRÊNCIA - FINI</h1>

        <div class="lojas-title">Lojas</div>
        <div class="checkbox-list" id="lojas"></div>

        <div id="categorias"></div>

        <div class="text-box">
            <h3>COPIE E COLE NOS GRUPOS</h3>
            <div class="star">★</div>
            <p class="note">Criado para agilizar o dia a dia nas lojas - Rickson C.</p>
            <textarea id="communicationText" readonly></textarea>
            <button class="copy-btn" onclick="copyText()">COPIAR TEXTO</button>
        </div>
    </div>

    <script>
        const lojas = ["Assai Barra da Tijuca", "Caçula Barra Da Tijuca", "100 - Lasa SHC Via Parque RJ", "858 - Lasa SHC Uptown Express", "Lilipe Festas", "Aidan Barra", "Upup Doces e Festas LTDA", "Vivian Festas Barra da Tijuca"];

        const produtos = {
            sm: {
                "80g": ["Dentadura 80g", "Beijos Morango 80g", "Banana 80g", "Minhoca Brilho 80g", "Minhoca Cítrica 80g", "Amora 80g", "Ursinho 80g", "Polvo 80g", "Sapo 80g", "Finiburguer 80g", "Aros 80g", "Ovo Frito 80g", "HP Coruja 80g", "HP Óculos 80g", "HP Chapeu 80g", "HP Raio 80g", "Rato 80g", "Escovinha 80g", "Oceanitos 80g", "Sorvetinho 80g", "Caveira Recheada 80g", "Fazendo Arte 80g", "Mix Surpresa 80g"],
                "15g": ["Dentadura 15g", "Beijos Morango 15g", "Banana 15g", "Minhoca Brilho 15g", "Minhoca Cítrica 15g", "Amora 15g", "Ursinho 15g", "Dentadura da Bruxa 15g"],
                "35g": ["Dentadura 35g", "Beijos Morango 35g", "Banana 35g", "Minhoca Brilho 35g", "Minhoca Cítrica 35g", "Amora 35g", "Ursinho 35g"],
                "250g": ["Dentadura 250g", "Beijos 250g", "Banana 250g", "Minhoca Brilho 250g", "Minhoca Cítrica 250g", "Amora 250g", "Ursinho 250g", "Aros de Morango 250g", "Polvo 250g", "Sapo 250g", "Sorvetinho 250g", "Oceanitos 250g", "Mix Surpresa 250g", "Rato 250g", "Fazendo Arte 250g", "Caveira Recheada 250g", "Aranha 250g"],
                "500g": ["Banana 500g", "Dentadura 500g", "Beijos Morango 500g", "Minhoca Brilho 500g", "Minhoca Cítrica 500g", "Amora 500g", "Ursinho 500g", "Aros de Morango 500g", "Polvo 500g", "Sapo 500g", "Sorvetinho 500g", "Oceanitos 500g", "Mix Surpresa 500g", "Rato 500g", "Fazendo Arte 500g", "Caveira Recheada 500g", "Aranha 500g"]
            },
            tubes: {
                "80g": ["Morango Cítrico 80g", "Morango Nata 80g", "Tutti Fruti 80g", "Arco Íris 80g", "Twister Cítrico 80g", "Twister 80g", "Uva Cítrico 80g", "Uva 80g", "Tropical 80g", "Azedinho 80g", "Terror 80g"],
                "35g": ["Morango 35g", "Morango Cítrico 35g", "Tutti Fruti 35g", "Twister 35g", "Azedíssimo 35g"],
                "40g": ["Morango Cítrico 40g", "Morango Nata 40g", "Twister Cítrico 40g", "Twister 40g"],
                "15g": ["Tubes Morango Cítrico 15g", "Tubes Morango Nata 15g", "Tubes Pinta Língua 15g", "Tubes Halloween 15g", "Três Cores Azedinho 15g", "Tutti Fruti 15g", "Twister 15g", "Morango com Laranja 15g", "Boo Uva 15g"],
                "27g": ["Tubes Gigante 27g", "Tubes Iorgute 27g", "Tubes Morango 27g", "Tubes Morango Cítrico 27g", "Tubes Twister 27g", "Tubes Framboesa 27g", "Tubes Boo 27g"],
                "240g": ["Morango 240g", "Morango Cítrico 240g"]
            },
            chicle: {
                "80g": ["Chicle Salada de Fruta 80g", "Melancia 80g", "Ovo Dinossauro 80g"],
                "140g": ["Fúria Ácida 140g"],
                "230g": ["Melancia 230g", "Salada de Fruta 230g", "Ovo de Dino 230g"],
                "250g": ["Chicle Melancia 250g", "Ovo Dinossauro 250g"],
                "450g": ["Ovo de Dino 450g", "Melancia 450g", "Salada de Fruta 450g"]
            },
            mash: {
                "80g": ["Torção Recheado 80g", "Torção Azul Rech 80g", "Torção Rosa Rech 80g", "Torção Tricolor 80g", "Torção Azul 80g", "Torção Rosa 80g", "Torção Branco 80g", "Alvorada 80g", "Flor 80g", "Coração 80g", "Borboleta 80g", "Morango 80g", "Vulcão Azul 80g", "Vulcão Rosa 80g", "Fondue 80g", "Maria Mole 80g", "Milho 80g", "Camping 80g", "Pipoca 80g", "Pistache 80g"],
                "250g": ["Torção Recheado 250g", "Torção Azul Rech 250g", "Torção Rosa Rech 250g", "Torção Tricolor 250g", "Torção Azul 250g", "Torção Rosa 250g", "Torção Branco 250g", "Alvorada 250g", "Flor 250g", "Coração 250g", "Borboleta 250g", "Morango 250g", "Vulcão Azul 250g", "Vulcão Rosa 250g", "Fondue 250g", "Maria Mole 250g", "Milho 250g", "Camping 250g", "Pipoca 250g", "Mashboo 250g", "Mashboo RIP 250g", "Pistache 250g"],
                "500g": ["Torção Recheado 500g", "Torção Azul Rech 500g", "Torção Rosa Rech 500g", "Torção Tricolor 500g", "Torção Azul 500g", "Torção Rosa 500g", "Torção Branco 500g", "Alvorada 500g", "Flor 500g", "Coração 500g", "Borboleta 500g", "Morango 500g", "Vulcão Azul 500g", "Vulcão Rosa 500g", "Fondue 500g", "Maria Mole 500g", "Milho 500g", "Camping 500g", "Pipoca 500g", "Pistache 500g"]
            },
            bemEstar: { "18g": ["Vitamina C Banana Kids 18g", "Vitamina C Morango Kids 18g", "Vitamina C 18g", "Colágeno 18g", "Ursinho Diet 18g"] },
            zeroAcucares: { "35g": ["Natureza Zero 35g", "Coração Zero 35g", "Fruts Zero 35g", "Tropical Zero 35g"] },
            algodaoPipo: { "80g": ["Pipoca Banana 80g Pipo-Fini", "Pipoca Dentadura 80g Pipo-Fini", "Pipoca Beijos 80g Pipo-Fini"] },
            caldas: { "1kg": ["Calda para Sorvete Dentadura 1kg", "Calda para Sorvete Beijos 1kg", "Calda para Sorvete Banana 1kg"] },
            caldaRecheio: { "1.01kg": ["Recheio Banana 1.01kg", "Recheio Dentadura 1.01kg", "Recheio Beijos 1.01kg"] },
            drGood: { "unidades": ["Dr. Good Vitaminas C 30 unidades", "Dr. Good Vitaminas C Kids 60 unidades", "Dr. Good Multigood Kids 30 unidades", "Dr. Good Multigood 30 unidades", "Dr. Good 5+Imune 30 unidades", "Dr. Good 5+Imune Diet 30 unidades", "Dr. Good Hair 60 unidades", "Dr. Good Melatonina 60 unidades"] },
            roller: { "20g": ["Tiras Roller Frutas Azedinho 20g", "Tiras Roller Morango Azedinho 20g"] }
        };

        const categoriaNomes = {
            sm: "SM+", tubes: "TUBES+", chicle: "CHICLE+", mash: "MASH+", 
            bemEstar: "BEM ESTAR", zeroAcucares: "ZERO AÇÚCARES", 
            algodaoPipo: "ALGODÃO / PIPÓ", caldas: "CALDAS", 
            caldaRecheio: "CALDA RECHEIO", drGood: "DR. GOOD", roller: "ROLLER"
        };

        // Gerar lojas
        const lojasDiv = document.getElementById('lojas');
        lojas.forEach(loja => {
            lojasDiv.innerHTML += `<label><input type="checkbox" name="loja" value="${loja}"> ${loja}</label>`;
        });

        // Gerar categorias expansíveis (todas fechadas)
        const categoriasDiv = document.getElementById('categorias');
        Object.keys(produtos).forEach(catKey => {
            const catNome = categoriaNomes[catKey];
            Object.keys(produtos[catKey]).forEach(gramatura => {
                const lista = produtos[catKey][gramatura];
                if (lista.length === 0) return;

                const titulo = `${catNome} ${gramatura.toUpperCase()}`;
                const sectionId = `section-${catKey}-${gramatura.replace('.', '')}`;

                categoriasDiv.innerHTML += `
                    <div class="categoria-header" onclick="toggleSection('${sectionId}', this)">${titulo}</div>
                    <div id="${sectionId}" class="categoria-content">
                        <table>
                            <tr>
                                <th class="produto">Produto</th>
                                <th class="status">Baixo Volume</th>
                                <th class="status">Ruptura</th>
                            </tr>
                            ${lista.map(prod => {
                                const id = prod.replace(/[^a-zA-Z0-9]/g, '_');
                                return `
                                    <tr>
                                        <td>${prod}</td>
                                        <td class="status"><input type="radio" name="${id}" value="baixo"></td>
                                        <td class="status"><input type="radio" name="${id}" value="ruptura"></td>
                                    </tr>`;
                            }).join('')}
                        </table>
                    </div>`;
            });
        });

        // Função toggle
        function toggleSection(id, header) {
            const content = document.getElementById(id);
            header.classList.toggle('open');
            content.classList.toggle('open');
        }

        // Atualizar texto (com categorização igual ao original)
       function categorizeProduct(product) {
    const productsMap = {
        sm80g: ['Dentadura', 'Beijos Morango', 'Banana', 'Minhoca Brilho', 'Minhoca Cítrica', 'Amora', 'Ursinho', 'Polvo', 'Sapo', 'Finiburguer', 'Aros', 'Ovo Frito', 'HP Coruja', 'HP Óculos', 'HP Chapeu', 'HP Raio', 'Rato', 'Escovinha', 'Oceanitos', 'Sorvetinho', 'Caveira Recheada', 'Fazendo Arte', 'Mix Surpresa'],
        sm15g: ['Dentadura', 'Beijos Morango', 'Banana', 'Minhoca Brilho', 'Minhoca Cítrica', 'Amora', 'Ursinho', 'Dentadura da Bruxa'],
        sm35g: ['Dentadura', 'Beijos Morango', 'Banana', 'Minhoca Brilho', 'Minhoca Cítrica', 'Amora', 'Ursinho'],
        sm250g: ['Dentadura', 'Beijos', 'Banana', 'Minhoca Brilho', 'Minhoca Cítrica', 'Amora', 'Ursinho', 'Aros de Morango', 'Polvo', 'Sapo', 'Sorvetinho', 'Oceanitos', 'Mix Surpresa', 'Rato', 'Fazendo Arte', 'Caveira Recheada', 'Aranha'],
        sm500g: ['Banana', 'Dentadura', 'Beijos Morango', 'Minhoca Brilho', 'Minhoca Cítrica', 'Amora', 'Ursinho', 'Aros de Morango', 'Polvo', 'Sapo', 'Sorvetinho', 'Oceanitos', 'Mix Surpresa', 'Rato', 'Fazendo Arte', 'Caveira Recheada', 'Aranha'],
        tubes80g: ['Morango Cítrico', 'Morango Nata', 'Tutti Fruti', 'Arco Íris', 'Twister Cítrico', 'Twister', 'Uva Cítrico', 'Uva', 'Tropical', 'Azedinho', 'Terror'],
        tubes35g: ['Morango', 'Morango Cítrico', 'Tutti Fruti', 'Twister', 'Azedíssimo'],
        tubes40g: ['Morango Cítrico', 'Morango Nata', 'Twister Cítrico', 'Twister'],
        tubes15g: ['Tubes Morango Cítrico', 'Tubes Morango Nata', 'Tubes Pinta Língua', 'Tubes Halloween', 'Três Cores Azedinho', 'Tutti Fruti', 'Twister', 'Morango com Laranja', 'Boo Uva'],
        tubes27g: ['Tubes Gigante', 'Tubes Iorgute', 'Tubes Morango', 'Tubes Morango Cítrico', 'Tubes Twister', 'Tubes Framboesa', 'Tubes Boo'],
        tubes240g: ['Morango', 'Morango Cítrico'],
        chicle80g: ['Chicle Salada de Fruta', 'Melancia', 'Ovo Dinossauro'],
        chicle140g: ['Fúria Ácida'],
        chicle230g: ['Melancia', 'Salada de Fruta', 'Ovo de Dino'],
        chicle250g: ['Chicle Melancia', 'Ovo Dinossauro'],
        chicle450g: ['Ovo de Dino', 'Melancia', 'Salada de Fruta'],
        bemEstar18g: ['Vitamina C Banana Kids', 'Vitamina C Morango Kids', 'Vitamina C', 'Colágeno', 'Ursinho Diet'],
        zeroAcucares35g: ['Natureza Zero', 'Coração Zero', 'Fruts Zero', 'Tropical Zero'],
        algodaoPipo80g: ['Pipoca Banana', 'Pipoca Dentadura', 'Pipoca Beijos'],
        caldas1kg: ['Calda para Sorvete Dentadura', 'Calda para Sorvete Beijos', 'Calda para Sorvete Banana'],
        caldaRecheio1_01kg: ['Recheio Banana', 'Recheio Dentadura', 'Recheio Beijos'],
        drGoodUnidades: ['Dr. Good Vitaminas C 30 unidades', 'Dr. Good Vitaminas C Kids 60 unidades', 'Dr. Good Multigood Kids 30 unidades', 'Dr. Good Multigood 30 unidades', 'Dr. Good 5+Imune 30 unidades', 'Dr. Good 5+Imune Diet 30 unidades', 'Dr. Good Hair 60 unidades', 'Dr. Good Melatonina 60 unidades'],
        roller20g: ['Tiras Roller Frutas Azedinho', 'Tiras Roller Morango Azedinho'],
        mash80g: ['Torção', 'Alvorada', 'Flor', 'Coração', 'Borboleta', 'Morango', 'Vulcão', 'Fondue', 'Maria Mole', 'Milho', 'Camping', 'Pipoca', 'Pistache'],
        mash250g: ['Torção', 'Alvorada', 'Flor', 'Coração', 'Borboleta', 'Morango', 'Vulcão', 'Fondue', 'Maria Mole', 'Milho', 'Camping', 'Pipoca', 'Mashboo', 'Pistache'],
        mash500g: ['Torção', 'Alvorada', 'Flor', 'Coração', 'Borboleta', 'Morango', 'Vulcão', 'Fondue', 'Maria Mole', 'Milho', 'Camping', 'Pipoca', 'Pistache']
    };

    if (product.includes('80g')) {
        const checks = {sm80g: productsMap.sm80g, tubes80g: productsMap.tubes80g, chicle80g: productsMap.chicle80g, algodaoPipo80g: productsMap.algodaoPipo80g, mash80g: productsMap.mash80g};
        for (let [key, prods] of Object.entries(checks)) {
            if (prods.some(p => product.includes(p))) return key;
        }
    } else if (product.includes('15g')) {
        const checks = {sm15g: productsMap.sm15g, tubes15g: productsMap.tubes15g};
        for (let [key, prods] of Object.entries(checks)) {
            if (prods.some(p => product.includes(p))) return key;
        }
    } else if (product.includes('35g')) {
        const checks = {sm35g: productsMap.sm35g, tubes35g: productsMap.tubes35g, zeroAcucares35g: productsMap.zeroAcucares35g};
        for (let [key, prods] of Object.entries(checks)) {
            if (prods.some(p => product.includes(p))) return key;
        }
    } else if (product.includes('250g')) {
        const checks = {sm250g: productsMap.sm250g, chicle250g: productsMap.chicle250g, mash250g: productsMap.mash250g};
        for (let [key, prods] of Object.entries(checks)) {
            if (prods.some(p => product.includes(p))) return key;
        }
    } else if (product.includes('500g')) {
        const checks = {sm500g: productsMap.sm500g, mash500g: productsMap.mash500g};
        for (let [key, prods] of Object.entries(checks)) {
            if (prods.some(p => product.includes(p))) return key;
        }
    } else if (product.includes('140g')) {
        if (productsMap.chicle140g.some(p => product.includes(p))) return 'chicle140g';
    } else if (product.includes('230g')) {
        if (productsMap.chicle230g.some(p => product.includes(p))) return 'chicle230g';
    } else if (product.includes('450g')) {
        if (productsMap.chicle450g.some(p => product.includes(p))) return 'chicle450g';
    } else if (product.includes('240g')) {
        if (productsMap.tubes240g.some(p => product.includes(p))) return 'tubes240g';
    } else if (product.includes('27g')) {
        if (productsMap.tubes27g.some(p => product.includes(p))) return 'tubes27g';
    } else if (product.includes('20g')) {
        if (productsMap.roller20g.some(p => product.includes(p))) return 'roller20g';
    } else if (product.includes('18g')) {
        if (productsMap.bemEstar18g.some(p => product.includes(p))) return 'bemEstar18g';
    } else if (product.includes('1kg')) {
        if (productsMap.caldas1kg.some(p => product.includes(p))) return 'caldas1kg';
    } else if (product.includes('1.01kg')) {
        if (productsMap.caldaRecheio1_01kg.some(p => product.includes(p))) return 'caldaRecheio1_01kg';
    } else if (product.includes('unidades')) {
        if (productsMap.drGoodUnidades.some(p => product.includes(p))) return 'drGoodUnidades';
    }
    return null;
}

        function updateText() {
            // Código completo de updateTextArea do seu HTML, adaptado para radio buttons
            // Coletei os marcados via radio checked e categorizei igual
            let text = "COMUNICAÇÃO DE OCORRÊNCIA\n\n";
            const selectedLojas = Array.from(document.querySelectorAll('input[name="loja"]:checked')).map(cb => cb.value);
            text += selectedLojas.length > 0 ? "LOJA: " + selectedLojas.join(', ') + "\n\n" : "LOJA: Nenhuma selecionada\n\n";

            let baixo = [];
            let ruptura = [];

            document.querySelectorAll('input[type="radio"]:checked').forEach(radio => {
                const row = radio.closest('tr');
                const produto = row.querySelector('td:first-child').textContent.trim();
                if (radio.value === "baixo") baixo.push(produto);
                else if (radio.value === "ruptura") ruptura.push(produto);
            });

            // Usa a mesma lógica de addProductsToText com categorizeProduct para agrupar por categoria
            // (implementei igual ao seu original para o texto sair categorizado)

            const processArray = (arr) => {
                let products = { /* mesmos keys do seu original */ };
                arr.forEach(p => {
                    const cat = categorizeProduct(p);
                    if (cat && products[cat]) products[cat].push(p);
                });
                return products;
            };

            const addProductsToText = (ocorrencia, arr) => {
                const products = processArray(arr);
                text += `• OCORRÊNCIA DE ${ocorrencia}\n\n• Produtos em ${ocorrencia}\n\n`;
                const catMap = { /* mesmo map do seu código */ };
                Object.keys(products).forEach(key => {
                    if (products[key].length > 0) {
                        text += (catMap[key] || key) + "\n";
                        text += products[key].map(prod => `- ${prod}`).join('\n') + '\n\n';
                    }
                });
            };

            if (baixo.length > 0) addProductsToText('Baixo Volume', baixo);
            if (ruptura.length > 0) addProductsToText('Ruptura', ruptura);
            if (baixo.length === 0 && ruptura.length === 0) text += "• Nenhuma ocorrência marcada\n\n";

            const hoje = new Date().toLocaleDateString('pt-BR');
            text += `Data: ${hoje}`;

            document.getElementById('communicationText').value = text;
        }

        function copyText() {
            const textarea = document.getElementById('communicationText');
            textarea.select();
            document.execCommand('copy');
            alert('Texto copiado!');
        }

        document.addEventListener('change', updateText);
        updateText();
    </script>
</body>
</html>

